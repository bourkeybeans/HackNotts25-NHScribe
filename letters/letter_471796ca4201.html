<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Letter - bob</title>
    <style>
        body {
            font-family: 'Times New Roman', serif;
            font-size: 12pt;
            line-height: 1.6;
            max-width: 8.5in;
            margin: 0 auto;
            padding: 1in;
            background-color: #ffffff;
            color: #000000;
        }
        
        .letterhead {
            border-bottom: 2px solid #003366;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .sender-info {
            font-weight: bold;
            font-size: 14pt;
            color: #003366;
            margin-bottom: 5px;
        }
        
        .sender-address {
            font-size: 10pt;
            color: #666666;
            margin-bottom: 10px;
        }
        
        .date {
            font-size: 12pt;
            margin-bottom: 30px;
        }
        
        .recipient {
            margin-bottom: 20px;
            font-size: 12pt;
        }
        
        .letter-body {
            font-size: 12pt;
            white-space: pre-wrap;
            margin-bottom: 30px;
        }
        
        .signature {
            margin-top: 40px;
            font-size: 12pt;
        }
        
        .signature-line {
            margin-bottom: 5px;
        }
        
        .signature-name {
            font-weight: bold;
        }
        
        .signature-title {
            font-style: italic;
            color: #666666;
            font-size: 11pt;
        }
        
        .download-section {
            margin-top: 30px;
            padding: 15px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            text-align: center;
            font-size: 12pt;
        }
        
        .download-btn {
            background: #1aa4af;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12pt;
            text-decoration: none;
            display: inline-block;
            margin: 5px;
            transition: background-color 0.2s;
        }
        
        .download-btn:hover {
            background: #c82333;
        }
        
        .download-btn:visited {
            color: white;
        }
        
        /* Editable content styling */
        .editable {
            border: 1px solid transparent;
            padding: 2px;
            border-radius: 3px;
            transition: border-color 0.2s;
        }
        
        .editable:hover {
            border-color: #cccccc;
        }
        
        .editable:focus {
            outline: none;
            border-color: #007bff;
            background-color: #f8f9fa;
        }
        
        /* Print styles */
        @media print {
            body {
                margin: 0;
                padding: 0.5in;
            }
            .download-section {
                display: none;
            }
            .editable {
                border: none;
            }
            .editable:hover {
                border: none;
            }
        }
    </style>
</head>
<body data-letter-id="471796ca4201">
    <div class="letterhead">
        <div class="sender-info">NHS</div>
        <div class="sender-address">
            123 Main Street<br>
            Springfield, USA 12345
        </div>
    </div>
    
    <div class="date">October 26, 2025</div>
    
    <div class="recipient">
        Dear bob,
    </div>
    
    <div class="letter-body editable" contenteditable="true" id="letter-content">
**Blood Test Results**

A blood test was performed to check your haemoglobin levels.

Your results show that your haemoglobin level is 118 g/L. This result falls within the normal range for adults, which is typically between 115 and 165 g/L.

Haemoglobin plays an important role in carrying oxygen throughout your body. If your level is low, it may indicate a decrease in red blood cell production or destruction. However, this result does not necessarily mean you have a medical condition. It's possible that your haemoglobin levels are fluctuating due to various factors such as iron deficiency, anaemia, or other underlying health issues.

If you experience any symptoms such as fatigue, shortness of breath, or pale skin, it is recommended that you consult with your healthcare provider for further evaluation and guidance. They may recommend additional tests or treatment to address any potential concerns.

Please note that these results are intended to provide general information only and should not be used to diagnose or manage any medical condition without consulting a qualified healthcare professional.
    </div>
    
    <div class="signature">
        <div class="signature-line">Sincerely,</div>
        <div class="signature-name">Dr. Smith</div>
        <div class="signature-title">NHS Medical Professional</div>
    </div>
    
    <div class="download-section">
        <p><strong>Download Options:</strong></p>
        <a href="/letters/471796ca4201/pdf" class="download-btn" target="_blank">
            Download PDF
        </a>
        <button class="download-btn" onclick="window.print()">
            Print Letter
        </button>
    </div>

    <script>
        // Auto-save functionality
        let saveTimeout;
        const letterContent = document.getElementById('letter-content');
        
        function autoSave() {
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                // Send updated content to server
                const updatedContent = letterContent.textContent;
                
                // Get letter ID from URL or data attribute
                const letterId = document.body.getAttribute('data-letter-id');
                if (letterId) {
                    fetch(`http://10.249.82.165:8000/letters/${letterId}/content`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ content: updatedContent })
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Auto-saved:', data);
                    })
                    .catch(error => {
                        console.error('Auto-save failed:', error);
                    });
                }
            }, 2000); // Save after 2 seconds of inactivity
        }
        
        // Add event listener for content changes
        letterContent.addEventListener('input', autoSave);
        
        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl+S to save
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                autoSave();
            }
        });
    </script>
</body>
</html>